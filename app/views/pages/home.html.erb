<div class="container">
  <div class="row">
    <div class="col-12 text-center logo-carr">
      <img class="img-fluid" src="https://i.ibb.co/CBtyrxS/logo-coworkers-6.png" alt="Coworkers-Logo">
    </div>
  </div>
</div>

<div class="container">
  <div class="row">
      <form id="search-form" action="<%= workspaces_path %>" method="GET">
        <div class="search-container">
          <input type="text" id="search-input" class="search-input" placeholder="Où souhaitez-vous télétravailler?" type="button">
          <input type="hidden" id="search-query" name="query">
        </div>
      </form>
    </div>
  </div>
</div>
<div class="container">
  <div class="mt-4">
    <h2 style="font-size: 20px;">Populaires</h2>
  </div>
</div>
<div class="container">
  <div class="row">
      <ul class="card-list">
        <% @workspaces.each do |workspace| %>
          <li><%= link_to workspace_path(workspace) do %>
            <article class="card">
              <img
                class="card__background"
                src=" <%= cl_image_path workspace.photos.first.key, width: 500, crop: :fill %>"
                alt="Photo d'un workspace"
                width="1920"
                height="2193"
              />
              <div class="card__content">
                <div class="card__content--container">
                  <h2 class="card__title"> <%= workspace.name %></h2>
                    <div class="divider">
                    </div>
                    <p class="card__description">
                      <%= workspace.ambiance %> | <%= workspace.smoking %> | <%= workspace.animals %>
                    </p>
                  </div>
                </div>
              </article>
            <% end %>
            </li>
          <% end %>
        </ul>
      </div>
    </div>
  </div>

<%#
    <div class="col-5 col-md-5 mb-4"> <!-- Utilisation de col-12 pour la disposition sur mobile et col-md-6 pour la disposition sur les écrans plus larges -->
    <a href="<%= workspaces_path%> <!-- Ajout du lien autour de la carte -->
<%#
      <article class="card">
        <img
          class="card__background"
          src="https://i.ibb.co/Q9Pzk5z/Large-SCH-2021-EPICERIE-mannequin-TELETRAVAIL-070.jpg"
          alt="Photo d'un bureau en hauteur"
          width="1920"
          height="2193"
        />
        <div class="card__content | flow">
          <div class="card__content--container | flow">
            <h2 style="font-size: 14px;" class="card__title">Chez Déborah</h2>
            <p style="font-size: 9px;"  class="card__description">
              Ambiance studieuse - Fumeur refusé - Un chien mignon
            </p>
          </div>
          <button style="font-size: 9px;" class="card__button">J'aime</button>
        </div>
      </article>
    </div>
  </div>
</div> %>
<%# </a> %>
<div class="container">
  <div class="mt-3">
    <h2 style="font-size: 35px;">Je souhaite proposer un workspace</h2>
  </div>
</div>
<div class="container">
    <div class="col-11 text-center">
          <div class="col-11 text-center">
            <a class="yellow-btn btn-home" href="<%= new_workspace_path %>">Ajouter un workspace</a>
      </div>
    </div>
</div>

<script>
document.addEventListener('turbo:load', () => {
  const searchInput = document.getElementById('search-input');
  const searchForm = document.getElementById('search-form');
  const searchQuery = document.getElementById('search-query');
  let isSecondClick = false;

  searchInput.addEventListener('click', () => {
    if (!isSecondClick) {
      isSecondClick = true;
      return;
    }

    handleSubmit();
  });

  searchInput.addEventListener('keydown', (event) => {
    if (event.key === 'Enter') {
      event.preventDefault();
      handleSubmit();
    }
  });

  searchForm.addEventListener('submit', (event) => {
    event.preventDefault();
  });

  function handleSubmit() {
    const inputValue = searchInput.value.trim();
    if (inputValue !== "") {
      searchQuery.value = inputValue;
      searchForm.submit();
      searchForm.reset();
      isSecondClick = false;
    }
  }
});
</script>
